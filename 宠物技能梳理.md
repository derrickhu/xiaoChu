# 宠物技能梳理文档

## 一、技能类型总览（28种）

| 技能类型 | 效果说明 | 使用的宠物数量 |
|---------|---------|--------------|
| dmgBoost | 下次指定属性伤害+X% | 10 |
| convertBead | 随机N颗珠子变为指定属性 | 7 |
| shield | 获得护盾N点 | 5 |
| reduceDmg | 本回合受到伤害-X% | 5 |
| stun | 敌人眩晕N回合 | 5 |
| instantDmg | 立即造成一次该属性伤害 | 5 |
| healOnElim | 消除对应属性珠时回血X% | 3 |
| beadRateUp | 指定属性珠出现概率大幅提升 | 5 |
| immuneCtrl | 免疫控制N回合 | 5 |
| reflectPct | 反弹X%伤害 | 3 |
| hpMaxUp | 血量上限+X% | 3 |
| stunPlusDmg | 眩晕+下次伤害+X% | 4 |
| healFlat | 立即回复N点血量 | 2 |
| dot | 敌人中毒/灼烧或回春 | 3 |
| comboPlus | 本次Combo+N | 2 |
| extraTime | 转珠时间+N秒 | 3 |
| ignoreDefPct | 下次该属性攻击无视X%防御 | 2 |
| revive | 抵挡一次致死伤害 | 1 |
| heartBoost | 心珠效果翻倍 | 1 |
| allDmgUp | 全属性伤害+X% | 1 |
| allAtkUp | 全队攻击+X% | 2 |
| allDefUp | 全队防御+X% | 2 |
| critBoost | 暴击率+X% | 2 |
| critDmgUp | 暴击伤害+X% | 1 |
| shieldOnElim | 消除对应属性珠获护盾 | 2 |
| comboNeverBreak | 本次Combo不会断 | 1 |
| lowHpDmgUp | 残血时伤害+X% | 1 |
| dmgImmune | 本回合伤害变1点 | 1 |
| guaranteeCrit | 指定属性必暴击（下回合该属性攻击必暴击） | 2 |
| teamAttack | 全队主动攻击（每只宠物按各自atk造成伤害） | 1 |
| replaceBeads | 将棋盘所有X属性珠替换为Y属性珠 | 1 |
| comboDmgUp | Combo伤害额外+X% | 1 |
| onKillHeal | 击杀回血X% | 1 |
| fullHeal | 满血回复 | 1 |
| allHpMaxUp | 全队血量上限+X% | 1 |
| percentAtkUp | 每N层叠加效果 | 0（已废弃，e17改为replaceBeads） |
| healPct | 立即回复X%最大血量 | 0（数据中无宠物使用） |

---

## 二、各技能类型检查状态

### ✅ 已生效的技能（无需修改）

| 技能类型 | 实现位置 | 说明 |
|---------|---------|------|
| dmgBoost | skills.js L40, battle.js L439/454 | 正确加入heroBuffs，结算时按属性应用 |
| convertBead | skills.js L41-48 | 正确修改棋盘珠子属性 |
| shield | skills.js L50-53 | 正确调用_addShield（含bonusPct） |
| reduceDmg | skills.js L56, battle.js L560 | 正确在敌方回合减伤 |
| stun（普通） | skills.js L58, battle.js L549-553 | 正确跳过敌人攻击回合 |
| comboPlus | skills.js L60 | 直接增加combo计数 |
| extraTime | skills.js L62 | 直接增加dragTimeLimit |
| revive | skills.js L66, runManager.js L155-159 | 正确设置tempRevive |
| healFlat | skills.js L70 | 正确回复固定血量 |
| dot（毒/灼烧） | skills.js L72-76, battle.js L608-612 | 正确给敌人加DoT |
| dot（回春） | skills.js L72-76, battle.js L511-516 | 正确给己方加regen |
| instantDmg | skills.js L78-86 | 正确直接扣敌方血量 |
| hpMaxUp | skills.js L88-91 | 正确增加血量上限和当前血量 |
| heartBoost | skills.js L93, battle.js L163-164 | ✅ 已修复，heroBuffs中heartBoost已在消除时检查 |
| allDmgUp | skills.js L95, battle.js L449/334 | 正确全属性加伤 |
| allAtkUp | skills.js L97, battle.js L338/452 | 正确加攻 |
| allDefUp | skills.js L99 | ✅ 已修复，enemyTurn减伤中已加入allDefUp累计 |
| critBoost | skills.js L101, battle.js L408 | 正确加暴击率 |
| critDmgUp | skills.js L103, battle.js L409 | 正确加暴击伤害 |
| reflectPct | skills.js L105, battle.js L578-584 | 正确反弹伤害 |
| beadRateUp | skills.js L109, battle.js L16-18 | 正确设置goodBeadsNextTurn |
| comboNeverBreak | skills.js L111, battle.js L87 | 正确允许无宠物属性也计combo |
| healOnElim | skills.js L113, battle.js L201-203 | 正确消除时回血 |
| shieldOnElim | skills.js L115, battle.js L207-209 | 正确消除时获盾 |
| stunPlusDmg | skills.js L118-121 | 正确加眩晕+伤害buff |
| fullHeal | skills.js L123 | 正确满血回复 |
| allHpMaxUp | skills.js L124-127 | 正确（同hpMaxUp实现） |
| dmgImmune | skills.js L129, battle.js L576-577 | 正确将伤害变为1 |
| comboDmgUp | skills.js L133, battle.js L315/455 | 正确Combo加伤 |

---

### ❌ 未生效的技能（需修复）

#### 1. `ignoreDefPct`（宠物技能版本）
- **宠物**：破甲金将(m9)、炎狱火龙(f19)
- **描述**：下次该属性攻击无视X%防御
- **问题**：`skills.js` L64 正确将buff加入 `heroBuffs`，但 `battle.js` `applyFinalDamage` 中只检查 `g.weapon.type === 'ignoreDefPct'`（L471），**完全没有检查 heroBuffs 中的 ignoreDefPct buff**
- **状态**：❌ 未生效

#### 2. `immuneCtrl`（宠物技能版本）
- **宠物**：灵芝仙菇(w13)、凝水灵蚌(s9)、冰凰神鸟(s20)、镇山石狮(e7)
- **描述**：免疫控制N回合/免疫持续伤害/免疫眩晕
- **问题**：`skills.js` L107 将buff加入 `heroBuffs`，但 `battle.js` `applyEnemySkill` 中的 stun 检查（L653）只检查 `g.immuneOnce` 和 `g.weapon.type === 'immuneStun'/'immuneCtrl'`，**没有检查 heroBuffs 中的 immuneCtrl buff**。对于 dot 类敌人技能（L635），也没有检查 immuneCtrl
- **状态**：❌ 未生效

#### 3. `onKillHeal`（宠物技能版本）
- **宠物**：火灵赤蛇(f9)
- **描述**：击杀怪物后回血50%
- **问题**：`skills.js` L135 正确加入 `heroBuffs`（dur:99），但 `battle.js` 胜利判定（L520-533）只检查 `g.weapon.type === 'onKillHeal'`（L524），**没有检查 heroBuffs 中的 onKillHeal buff**
- **状态**：❌ 未生效

#### 4. `percentAtkUp`
- **宠物**：后土灵蚕(e17)
- **描述**：每5层血量上限+5%
- **问题**：`skills.js` 的 switch 中**完全没有 percentAtkUp 的 case**！技能释放后什么都不会发生
- **状态**：❌ 未实现

#### 5. `lowHpDmgUp`（触发条件）
- **宠物**：火灵神猫(f20)
- **描述**：残血时临时伤害+30%
- **问题**：`skills.js` L117 加入 heroBuffs（dur:3），`battle.js` L341/456 检查 `g.heroHp / g.heroMaxHp <= 0.3` 才生效。但 dur=3 意味着 3 回合后就消失。**技能描述说「残血时」，实际效果是3回合内残血时才有加成**，这个算是可以的，但技能是主动释放的3回合持续，不是被动。实现逻辑正确
- **状态**：✅ 已生效（描述稍有歧义但可接受）

#### 6. `allDefUp`（宠物技能版本）
- **宠物**：玄水神蛟(s18)、后土神兽(e10)
- **描述**：全队防御+X%，持续N回合
- **问题**：`skills.js` L99 正确将buff加入 `heroBuffs`，但 `battle.js` 的敌人攻击流程中（`enemyTurn` L556-564），减伤计算只累计 `reduceDmg` 类型的buff，**完全没有处理 allDefUp 类型的buff**。allDefUp应该减少敌人对我方的伤害
- **状态**：❌ 未生效

---

### ❓ 有疑问的技能（等待确认）

#### 1. `stun chance` — 玄土灵蛤(e14)被动概率眩晕
- **描述**「被攻击20%概率眩晕敌人」→ 确认为法宝技能，不是宠物主动技能
- **当前状态**：暂保留为主动眩晕1回合，后续更换新技能并通过法宝实现概率眩晕
- **标记**：`_pendingRedesign: true`

---

## 四-B、本次修改记录

### 修改1：m13金影刺客 — `guaranteeCrit` 改为属性暴击
- **原技能**：`消除5个金珠必定暴击`（type:guaranteeCrit, minCount:5）→ 实现为无条件100%暴击
- **新技能**：`下回合金属性攻击必定暴击`（type:guaranteeCrit, attr:'metal'）
- **改动**：
  - `pets.js`：修改desc和参数，去掉minCount
  - `skills.js`：guaranteeCrit case改为push `guaranteeCrit` buff（含attr字段），不再用critBoost
  - `battle.js` calcCrit：新增heroBuffs中guaranteeCrit的检查，有attr则只在该属性有伤害时生效

### 修改2：f13烈阳火鹰 — 改为全队主动攻击 `teamAttack`
- **原技能**：`消除5火珠触发全体攻击`（type:guaranteeCrit）→ 描述与类型不符
- **新技能**：`触发全队主动攻击，每只宠物造成各自攻击力的伤害`（type:teamAttack）
- **改动**：
  - `pets.js`：修改type为teamAttack，更新desc
  - `skills.js`：新增teamAttack case，遍历全队宠物按各自atk对敌人造成伤害，含allAtkPct和skillDmgPct加成

### 修改3：f18火元灵龟 — 实现 `critBoostPerCombo` 递增暴击率
- **原问题**：perCombo:true标记被忽略，实际只固定+5%暴击率
- **改动**：
  - `skills.js`：critBoost case检查sk.perCombo，若有则push类型为critBoostPerCombo的buff
  - `battle.js` calcCrit：新增critBoostPerCombo检查，暴击率 = pct × combo段数

### 修改4：e14玄土灵蛤 — 标记为法宝技能待更换
- **原问题**：`被攻击20%概率眩晕敌人` 是被动效果，不适合作为主动技能
- **处理**：在pets.js中添加 `_pendingRedesign:true` 标记，desc改为「【待更换】」提示
- **后续**：需设计新的主动技能替换，概率眩晕效果改为法宝实现

### 修改5：w9木灵使者 — 心珠效果翻倍改为3回合
- **原数据**：dur:1（1回合）
- **新数据**：dur:3（3回合）
- **改动**：pets.js中w9的dur从1改为3，desc更新为「3回合内心珠效果翻倍」
- **注**：heartBoost的heroBuffs检查已在上次修复中实现

### 修改6：e17后土灵蚕 — 改为棋盘替换珠 `replaceBeads`
- **原技能**：`每5层血量上限+5%`（type:percentAtkUp）→ 被动效果，不适合主动技能
- **新技能**：`将棋盘所有水珠替换为土珠`（type:replaceBeads, fromAttr:'water', toAttr:'earth'）
- **设计说明**：土克水，所以替换水珠→土珠。其他属性同理：金→木珠变金珠，木→土珠变木珠，水→火珠变水珠，火→金珠变火珠
- **改动**：
  - `pets.js`：修改e17的type/desc/参数
  - `skills.js`：新增replaceBeads case，遍历棋盘替换所有fromAttr珠为toAttr珠
  - `skills.js`：移除percentAtkUp case（已无宠物使用）

---

## 三、按属性分类的100只宠物

### 金属性（20只）
| ID | 名称 | 攻击 | 技能名 | 技能效果 | CD | 状态 |
|----|------|------|--------|---------|-----|------|
| m1 | 金锋灵猫 | 7 | 锋芒 | 下次金属性伤害+30% | 6 | ✅ |
| m2 | 锐金鼠将 | 8 | 化金 | 随机3颗珠子变金珠 | 7 | ✅ |
| m3 | 玄甲金狮 | 8 | 金甲 | 本回合受伤-40% | 8 | ✅ |
| m4 | 天罡金鹏 | 9 | 金击 | 立即造成金属性伤害(150%) | 7 | ✅ |
| m5 | 碎金战将 | 10 | 金缚 | 敌人眩晕1回合 | 9 | ✅ |
| m6 | 金光剑灵 | 10 | 剑意 | 本次Combo+2 | 8 | ✅ |
| m7 | 金罡守卫 | 8 | 金盾 | 获得护盾50点 | 9 | ✅ |
| m8 | 鸣金神雀 | 9 | 鸣金 | 转珠时间+2秒 | 10 | ✅ |
| m9 | 破甲金将 | 11 | 破甲 | 下次金攻无视50%防御 | 8 | ❌ 未生效 |
| m10 | 九天金凰 | 11 | 金身 | 抵挡致死伤害1次 | 12 | ✅ |
| m11 | 锐金斥候 | 10 | 锐金 | 下次金属性伤害+60% | 7 | ✅ |
| m12 | 金纹战将 | 10 | 金愈 | 消除金珠回血10% | 8 | ✅ |
| m13 | 金影刺客 | 11 | 金刺 | 下回合金属性攻击必暴击 | 9 | ✅ 已修改 |
| m14 | 金甲神卫 | 9 | 神卫 | 受到伤害-20% | 8 | ✅ |
| m15 | 金虹使者 | 11 | 金虹 | 随机5颗变金珠 | 10 | ✅ |
| m16 | 金罡战魂 | 10 | 战魂 | 伤害变为1点 | 11 | ✅ |
| m17 | 金翎神使 | 10 | 金翎 | 金珠概率提升 | 9 | ✅ 已修复 |
| m18 | 金锋战神 | 12 | 战意 | 全队攻击+25%持续3回合 | 12 | ✅ |
| m19 | 金耀星君 | 11 | 星耀 | 眩晕+金伤+50% | 10 | ✅ |
| m20 | 万钧金神 | 13 | 万钧 | 立即巨额金伤(300%) | 11 | ✅ |

### 木属性（20只）
| ID | 名称 | 攻击 | 技能名 | 技能效果 | CD | 状态 |
|----|------|------|--------|---------|-----|------|
| w1 | 青灵木鹿 | 7 | 春愈 | 立即回复40点生命 | 6 | ✅ |
| w2 | 藤萝灵蛇 | 7 | 毒蛇 | 敌人中毒每回合20血3回合 | 8 | ✅ |
| w3 | 苍木灵熊 | 8 | 熊力 | 本回合受伤-40% | 8 | ✅ |
| w4 | 万木灵狐 | 8 | 木化 | 随机3颗变木珠 | 7 | ✅ |
| w5 | 灵木仙子 | 9 | 回春 | 每回合回血20点3回合 | 9 | ✅ |
| w6 | 青木战灵 | 10 | 木灵 | 下次木属性伤害+50% | 7 | ✅ |
| w7 | 缠枝藤君 | 9 | 缠枝 | 敌人眩晕1回合 | 9 | ✅ |
| w8 | 枯木老妖 | 8 | 古木 | 血量上限+20% | 8 | ✅ |
| w9 | 木灵使者 | 10 | 灵心 | 3回合内心珠效果翻倍 | 9 | ✅ 已修改 |
| w10 | 万木之主 | 11 | 万木 | 全属性伤害+20%持续3回合 | 12 | ✅ |
| w11 | 青藤守卫 | 8 | 藤盾 | 获得厚护盾70点 | 9 | ✅ |
| w12 | 翠竹灵蟋 | 10 | 木锐 | 下次木伤+70% | 8 | ✅ |
| w13 | 灵芝仙菇 | 8 | 净化 | 免疫持续伤害1回合 | 8 | ❌ 未生效 |
| w14 | 苍蟒木蛟 | 10 | 生机 | 消除木珠回血8% | 7 | ✅ |
| w15 | 木灵仙鹿 | 9 | 仙愈 | 满血回复 | 12 | ✅ |
| w16 | 千年古藤 | 11 | 仙木 | 随机5颗变木珠 | 10 | ✅ |
| w17 | 碧玉螳螂 | 10 | 元木 | Combo不会断 | 8 | ✅ |
| w18 | 青鸾翠雀 | 10 | 木元 | 木珠概率提升 | 9 | ✅ 已修复 |
| w19 | 万木神龟 | 11 | 灵木 | 全队血量上限+30% | 11 | ✅ |
| w20 | 神木麒麟 | 13 | 神木 | 立即高额木伤(300%) | 10 | ✅ |

### 水属性（20只）
| ID | 名称 | 攻击 | 技能名 | 技能效果 | CD | 状态 |
|----|------|------|--------|---------|-----|------|
| s1 | 沧澜水雀 | 7 | 水化 | 随机3颗变水珠 | 7 | ✅ |
| s2 | 冰魄灵龟 | 8 | 冰甲 | 本回合受伤-50% | 9 | ✅ |
| s3 | 海灵蛟童 | 8 | 冰封 | 冰冻敌人1回合 | 9 | ✅ |
| s4 | 玄水蛟龙 | 9 | 水击 | 立即造成水伤(150%) | 7 | ✅ |
| s5 | 碧波灵蛙 | 8 | 碧波 | 回复60点生命 | 8 | ✅ |
| s6 | 流水灵鱼 | 10 | 水灵 | 下次水属性伤害+50% | 7 | ✅ |
| s7 | 寒冰灵蟹 | 9 | 寒川 | 反弹20%伤害2回合 | 9 | ✅ |
| s8 | 海魂巨鲸 | 10 | 海魂 | 消除水珠回血8% | 8 | ✅ |
| s9 | 凝水灵蚌 | 8 | 凝水 | 免疫眩晕1次 | 10 | ❌ 未生效 |
| s10 | 沧海龙神 | 12 | 沧海 | 全场一半变水珠(18颗) | 13 | ✅ |
| s11 | 冰玄灵蛾 | 10 | 冰玄 | 水珠概率提升 | 9 | ✅ 已修复 |
| s12 | 沧澜海蛇 | 11 | 澜击 | 下次水伤+70% | 8 | ✅ |
| s13 | 玄水灵蟾 | 9 | 水盾 | 获得护盾60点 | 9 | ✅ |
| s14 | 冰魄灵鹤 | 11 | 冰魄 | 眩晕+水伤+40% | 10 | ✅ |
| s15 | 海灵水母 | 10 | 海灵 | 转珠时间+2秒 | 10 | ✅ |
| s16 | 水镜灵蝶 | 10 | 水镜 | 反弹30%伤害1回合 | 9 | ✅ |
| s17 | 沧澜鲲鹏 | 13 | 仙澜 | 立即巨额水伤(300%) | 11 | ✅ |
| s18 | 玄水神蛟 | 11 | 玄水 | 全队防御+30%持续3回合 | 12 | ❌ 未生效 |
| s19 | 水纹灵獭 | 10 | 水纹 | 消除水珠获护盾40点 | 8 | ✅ |
| s20 | 冰凰神鸟 | 10 | 冰凰 | 免疫所有控制1回合 | 10 | ❌ 未生效 |

### 火属性（20只）
| ID | 名称 | 攻击 | 技能名 | 技能效果 | CD | 状态 |
|----|------|------|--------|---------|-----|------|
| f1 | 赤焰火狐 | 7 | 焰爪 | 下次火伤+40% | 6 | ✅ |
| f2 | 焚天火狼 | 8 | 火化 | 随机3颗变火珠 | 7 | ✅ |
| f3 | 烈阳火凰 | 10 | 烈阳 | 立即高额火伤(200%) | 8 | ✅ |
| f4 | 炎狱火麟 | 10 | 暴燃 | 本次必定暴击 | 9 | ✅ |
| f5 | 爆炎火蟾 | 9 | 灼烧 | 敌人灼烧每回合25血3回合 | 9 | ✅ |
| f6 | 火莲灵花 | 10 | 火莲 | Combo伤害额外+30% | 8 | ✅ |
| f7 | 焚天火鸦 | 10 | 焚天 | 敌人眩晕1回合 | 9 | ✅ |
| f8 | 赤炎火蝎 | 10 | 炎魔 | Combo+3 | 8 | ✅ |
| f9 | 火灵赤蛇 | 9 | 火愈 | 击杀回血50% | 10 | ❌ 未生效 |
| f10 | 朱雀神火 | 12 | 神火 | 暴击率+50%持续3回合 | 12 | ✅ |
| f11 | 焚天火猿 | 11 | 焚魂 | 火珠概率提升 | 9 | ✅ 已修复 |
| f12 | 炎狱火蜥 | 11 | 炎狱 | 下次火伤+70% | 8 | ✅ |
| f13 | 烈阳火鹰 | 10 | 烈灵 | 触发全队主动攻击 | 9 | ✅ 已修改 |
| f14 | 火凰灵蝶 | 11 | 凰翼 | 暴击伤害+50% | 10 | ✅ |
| f15 | 炎爆火鼠 | 11 | 炎爆 | 眩晕+火伤+50% | 10 | ✅ |
| f16 | 焚天火蟒 | 13 | 天焚 | 立即巨额火伤(350%) | 11 | ✅ |
| f17 | 赤焰麒麟 | 12 | 战焰 | 全队攻击+30%持续3回合 | 12 | ✅ |
| f18 | 火元灵龟 | 11 | 火元 | 每段Combo暴击率+5% | 9 | ✅ 已修改 |
| f19 | 炎狱火龙 | 11 | 炎神 | 火伤无视25%防御 | 9 | ❌ 未生效 |
| f20 | 火灵神猫 | 10 | 余烬 | 残血时伤害+30% | 10 | ✅ |

### 土属性（20只）
| ID | 名称 | 攻击 | 技能名 | 技能效果 | CD | 状态 |
|----|------|------|--------|---------|-----|------|
| e1 | 厚土石灵 | 8 | 厚土 | 本回合受伤-40% | 8 | ✅ |
| e2 | 山岳石怪 | 8 | 土化 | 随机3颗变土珠 | 7 | ✅ |
| e3 | 镇地石犀 | 9 | 镇地 | 获得厚护盾80点 | 9 | ✅ |
| e4 | 玄武圣兽 | 10 | 玄武 | 眩晕敌人1回合 | 9 | ✅ |
| e5 | 裂地穿山甲 | 11 | 裂地 | 下次土伤+60% | 7 | ✅ |
| e6 | 山岩石蟹 | 9 | 山岩 | 血量上限+30% | 10 | ✅ |
| e7 | 镇山石狮 | 10 | 石尊 | 免疫所有控制1回合 | 10 | ❌ 未生效 |
| e8 | 大地灵鼹 | 10 | 大地 | 反弹30%伤害1回合 | 9 | ✅ |
| e9 | 玄土石蟒 | 11 | 玄土 | 立即造成土属性高额伤害(250%) | 10 | ✅ |
| e10 | 后土神兽 | 12 | 后土 | 全队防御+50%持续3回合 | 13 | ❌ 未生效 |
| e11 | 厚土灵虫 | 10 | 土魂 | 土珠概率提升 | 9 | ✅ 已修复 |
| e12 | 山岳灵兔 | 11 | 岳击 | 下次土伤+70% | 8 | ✅ |
| e13 | 镇地石龙 | 10 | 镇盾 | 护盾效果+50%(60+bonusPct) | 9 | ✅ |
| e14 | 玄土灵蛤 | 11 | 震慑 | 【待更换】暂为主动眩晕，后续改法宝 | 10 | ⏳ 待更换 |
| e15 | 裂地灵蚁 | 10 | 裂盾 | 消除土珠获护盾50点 | 8 | ✅ |
| e16 | 山岩石象 | 10 | 岩甲 | 受伤-30% | 9 | ✅ |
| e17 | 后土灵蚕 | 9 | 地脉 | 将棋盘所有水珠替换为土珠 | 10 | ✅ 已修改 |
| e18 | 镇地神牛 | 13 | 天镇 | 立即巨额土伤(300%) | 11 | ✅ |
| e19 | 厚土灵龟 | 10 | 仙土 | 血量上限+40% | 11 | ✅ |
| e20 | 玄武神君 | 12 | 神武 | 眩晕+土伤+50% | 10 | ✅ |

---

## 四、修复总结

### 第一轮修复（确认无误，共7个）：
1. **ignoreDefPct heroBuffs 未应用** — 影响2只宠物(m9,f19) ✅ 已修复
2. **immuneCtrl heroBuffs 未检查** — 影响4只宠物(w13,s9,s20,e7) ✅ 已修复
3. **onKillHeal heroBuffs 未检查** — 影响1只宠物(f9) ✅ 已修复
4. **percentAtkUp 完全未实现** — 影响1只宠物(e17) → ✅ 已改为replaceBeads
5. **allDefUp heroBuffs 未应用** — 影响2只宠物(s18,e10) ✅ 已修复
6. **heartBoost heroBuffs 未检查** — 影响1只宠物(w9) ✅ 已修复
7. **beadRateUp 中途释放无效** — 影响5只宠物(m17,w18,s11,f11,e11) ✅ 已修复

### 第二轮修改（用户确认后，共6个）：
1. **m13金影刺客** — guaranteeCrit改为属性暴击（下回合金属性必暴击） ✅ 已修改
2. **f13烈阳火鹰** — 新增teamAttack类型（全队主动攻击，各宠物按atk造伤害） ✅ 已修改
3. **f18火元灵龟** — 实现critBoostPerCombo递增暴击率（每段Combo+5%） ✅ 已修改
4. **e14玄土灵蛤** — 标记_pendingRedesign，概率眩晕改为法宝实现 ⏳ 待更换
5. **w9木灵使者** — heartBoost dur从1改为3（3回合内心珠翻倍） ✅ 已修改
6. **e17后土灵蚕** — 改为replaceBeads（水珠→土珠），percentAtkUp已废弃 ✅ 已修改

### 仍有待处理（1个）：
1. **e14玄土灵蛤** — 需要设计新的主动技能替换当前的震慑，概率眩晕效果改由法宝实现
